/* IMS theme variables and fallbacks */
:root {
    --bg: #f8fafc; /* light background */
    --text: #0f172a; /* dark text */
    --primary: #0d9488; /* teal */
    --muted: #6b7280;
    --card: #ffffff;
    --surface-1: #ffffff;
    --surface-2: #f1f5f9;
}

/* OS-level dark preference fallback */
@media (prefers-color-scheme: dark) {
    :root {
        --bg: #0b1220;
        --text: #e6eef8;
        --primary: #66b2ff;
        --muted: #9fb3c8;
        --card: #0f1a2b;
        --surface-1: #0f1724;
        --surface-2: #0b1220;
    }
}

/* Explicit user selection via html[data-theme] should override media queries */
html[data-theme="dark"] {
    --bg: #0b1220;
    --text: #e6eef8;
    --primary: #66b2ff;
    --muted: #9fb3c8;
    --card: #0f1a2b;
    --surface-1: #0f1724;
    --surface-2: #0b1220;
}

html[data-theme="light"] {
    --bg: #f8fafc;
    --text: #0f172a;
    --primary: #0d9488;
    --muted: #6b7280;
    --card: #ffffff;
    --surface-1: #ffffff;
    --surface-2: #f1f5f9;
}

/* Base styles */
body {
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI",
        Roboto, "Helvetica Neue", Arial;
    background: var(--bg);
    color: var(--text);
    transition: background 0.25s ease, color 0.25s ease;
}

.navbar,
.card,
.table {
    background: var(--card);
}

.btn-primary {
    background: var(--primary);
    border-color: var(--primary);
}

/* Ensure header / primary nav links are always readable according to current theme */
header a,
header a:visited,
header .nav-link,
nav a {
    color: var(--text) !important;
}

header a:hover,
nav a:hover {
    color: var(--primary) !important;
}

/* Ensure the 'active' nav highlight (bg-slate-200) matches light theme surfaces */
header .bg-slate-200 {
    background-color: var(--surface-2) !important;
    color: var(--text) !important;
}

/* In dark mode, make sure active highlight is the dark surface */
/* In dark mode, make the active nav highlight subtly lighter than the header so it remains visible */
html.dark header .bg-slate-200,
html[data-theme="dark"] header .bg-slate-200 {
    background-color: rgba(255, 255, 255, 0.06) !important;
    color: var(--text) !important;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.02);
}

/* Hover fallbacks used by nav links (ensure visibility) */
header .hover\:bg-slate-100:hover,
header .hover\:bg-slate-50:hover {
    background-color: var(--surface-2) !important;
}
html.dark header .hover\:bg-slate-100:hover,
html.dark header .hover\:bg-slate-50:hover,
html[data-theme="dark"] header .hover\:bg-slate-100:hover,
html[data-theme="dark"] header .hover\:bg-slate-50:hover {
    background-color: rgba(255, 255, 255, 0.02) !important;
}

/* Skip link for accessibility */
.skip-link {
    position: absolute;
    left: -999px;
    top: auto;
    width: 1px;
    height: 1px;
    overflow: hidden;
}
.skip-link:focus {
    left: 10px;
    top: 10px;
    width: auto;
    height: auto;
    padding: 8px 12px;
    background: var(--primary);
    color: #fff;
    z-index: 9999;
    border-radius: 4px;
}

/* Focus styles */
a:focus,
button:focus,
input:focus,
select:focus,
textarea:focus {
    outline: 3px solid rgba(102, 178, 255, 0.25);
    outline-offset: 3px;
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    * {
        transition: none !important;
    }
}

/* Lightweight animations */
.fade-in {
    animation: fadeIn 0.45s ease both;
}
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(6px);
    }
    to {
        opacity: 1;
        transform: none;
    }
}

.btn-animated {
    transition: transform 0.18s ease, box-shadow 0.18s ease;
}
.btn-animated:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
}

/* Accessible table striping */
table.table tbody tr:nth-child(odd) {
    background: rgba(0, 0, 0, 0.02);
}

/* Ensure table row hover uses light surface in light theme */
html:not(.dark) tr.hover\:bg-slate-50:hover,
html[data-theme="light"] tr.hover\:bg-slate-50:hover,
html:not(.dark) .hover\:bg-slate-50:hover,
html[data-theme="light"] .hover\:bg-slate-50:hover {
    background-color: var(--surface-2) !important;
    color: var(--text) !important;
}

/* Also handle hover:bg-slate-100 fallback */
html:not(.dark) .hover\:bg-slate-100:hover,
html[data-theme="light"] .hover\:bg-slate-100:hover {
    background-color: var(--surface-2) !important;
    color: var(--text) !important;
}

/* Utility fallbacks to keep colors readable if Tailwind dark: classes aren't applied */
html:not(.dark) .bg-white {
    background-color: var(--surface-1) !important;
}
html:not(.dark) .bg-slate-50 {
    background-color: var(--surface-2) !important;
}
html:not(.dark) .text-slate-500 {
    color: var(--muted) !important;
}
html:not(.dark) .border-slate-200 {
    border-color: rgba(15, 23, 42, 0.06) !important;
}

html.dark .bg-white {
    background-color: var(--card) !important;
}
html.dark .bg-slate-50 {
    background-color: rgba(255, 255, 255, 0.02) !important;
}
html.dark .text-slate-500 {
    color: var(--muted) !important;
}
html.dark .border-slate-200 {
    border-color: rgba(255, 255, 255, 0.06) !important;
}

/* Ensure nav hover contrast */
html.dark a:hover,
html.dark button:hover {
    color: inherit;
}

/* Ensure header buttons and their icons are readable in both themes */
header button,
header button i,
header .fa {
    color: var(--text) !important;
    background: transparent !important;
}

/* Small icon buttons (font controls) */
header .p-1 {
    background: transparent !important;
    color: var(--text) !important;
}
header .p-1:hover {
    background: var(--surface-2) !important;
    color: var(--text) !important;
}

/* Theme-toggle and other header buttons that use Tailwind bg- classes */
header .bg-slate-200,
header .bg-slate-300,
header .bg-slate-700,
header .bg-slate-600 {
    color: var(--text) !important;
}

/* Dark mode exceptions: keep high-contrast buttons (like TTS) readable */
html.dark header .p-1,
html[data-theme="dark"] header .p-1 {
    color: var(--text) !important;
}

/* Ensure logged-in user name in header is visible in both themes */
header .user-name {
    color: var(--text) !important;
}
/* Toast notifications */
.toast-container {
    position: fixed;
    bottom: 1rem;
    right: 1rem;
    top: auto;
    z-index: 99999;
    display: flex;
    flex-direction: column-reverse;
    align-items: flex-end;
    gap: 0.5rem;
    max-width: calc(100% - 2rem);
}
.toast {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
    padding: 0.6rem 0.8rem;
    border-radius: 8px;
    box-shadow: 0 8px 30px rgba(2, 6, 23, 0.12);
    color: #fff;
    min-width: 220px;
    max-width: 420px;
    font-size: 0.95rem;
    opacity: 1;
    transition: transform 0.18s ease, opacity 0.18s ease;
}
.toast-hide {
    opacity: 0;
    transform: translateY(-6px);
}
.toast .toast-close {
    background: transparent;
    border: none;
    color: inherit;
    font-size: 1.1rem;
    cursor: pointer;
}
.toast .toast-content {
    flex: 1;
    padding-right: 0.5rem;
    color: inherit;
}

/* Default: use single solid colors (works well in dark mode) */
.toast-success {
    background: var(--primary) !important;
    color: #fff !important;
}
.toast-error {
    background: #dc2626 !important;
    color: #fff !important;
}
.toast-warning {
    background: #d97706 !important;
    color: #0f172a !important;
}
.toast-info {
    background: #059669 !important;
    color: #fff !important;
}

/* Light theme: softer backgrounds or gradients for non-success types */
html[data-theme="light"] .toast-success {
    color: #064e3b;
    background: linear-gradient(180deg, #ecfdf5, #f0fdf4);
    border: 1px solid rgba(6, 78, 59, 0.08);
    box-shadow: 0 6px 18px rgba(15, 23, 42, 0.03);
}
html[data-theme="light"] .toast-error {
    color: #fff;
}
html[data-theme="light"] .toast-warning {
    color: #111827;
    background: linear-gradient(180deg, #fff4e6, #fff7ed);
    box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
    border: 1px solid rgba(15, 23, 42, 0.04);
}
html[data-theme="light"] .toast-info {
    color: #0f172a;
    background: linear-gradient(180deg, #e6f6ff, #eef8ff);
    box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
    border: 1px solid rgba(15, 23, 42, 0.04);
}

/* Dark theme: ensure solid single-color toasts for legibility */
html.dark .toast-success,
html[data-theme="dark"] .toast-success {
    background: var(--primary) !important;
    background-image: none !important;
    color: #fff !important;
}
html.dark .toast-error,
html[data-theme="dark"] .toast-error {
    background: #dc2626 !important;
    background-image: none !important;
    color: #fff !important;
}
html.dark .toast-warning,
html[data-theme="dark"] .toast-warning {
    background: #d97706 !important;
    background-image: none !important;
    color: #0f172a !important;
}
html.dark .toast-info,
html[data-theme="dark"] .toast-info {
    background: #059669 !important;
    background-image: none !important;
    color: #fff !important;
}
